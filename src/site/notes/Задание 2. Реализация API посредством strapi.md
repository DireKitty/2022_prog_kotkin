---
{"dg-publish":true,"permalink":"/zadanie-2-realizacziya-api-posredstvom-strapi/"}
---

### Полезные материалы

- [https://habr.com/ru/articles/38730/](https://habr.com/ru/articles/38730/) - REST
- [https://systems.education/what-is-rest](https://systems.education/what-is-rest)

### Чек-лист требований

- [x]  Есть скриншоты с основными ключевыми этапами;
- [x]  Скриншоты прокомментированы;
- [x]  К первому дедлайну реализована как минимум одна сущность;
- [ ]  Ко второму дедлайну реализован весь проект;
- [x]  Противоречия в ТЗ (при наличии) прокомментированы;
- [x]  Отчет отформатирован.
### Отчет

В качестве условий и ТЗ, которые мне необходимо соблюсти и выполнить, мне досталась работа Шабеко Софьи. Для удобства, оставлю ссылку на ее работу тут. 
https://formygarden.vercel.app

Сама же идея звучит так:
Необходимо создать приложение, в котором пользователи смогут добавлять в свой профиль предпочтительные для просмотра фильмы и сериалы, отмечать в своем профиле просмотренные фильмы и сериалы, ставить оценку и оставлять комментарии на просмотренные фильмы и сериалы, а также добавлять других пользователей и делиться с ними впечатлениями, советовать любимые фильмы и сериалы к просмотру.

### Установка Strapi

Для выполнения первого этапа задания необходимо установить Strapi, и хотя я уже выполнял эту задачу ранее для тестирования функционала и проверки работы системы, на этот раз я решил повторить процесс установки, так как теперь требуется пошаговое описание процесса и скриншоты.

На этот раз я подошел к процессу установки более подготовленно. Убедившись, что все необходимые программы и зависимости установлены, я также заранее проверил их актуальность. В предыдущий раз у меня возникли трудности с несовместимостью версий и отсутствием некоторых пакетов, что потребовало дополнительной настройки. На этот раз эти вопросы были решены заранее.

![Pasted image 20240917101139.png](/img/user/Pasted%20image%2020240917101139.png)

![Pasted image 20240917101241.png](/img/user/Pasted%20image%2020240917101241.png)
### Cущность Пользователь (user)
Создание API начнем с создания первой сущности, а именно Пользователя (user). Но для того, чтоб не добавлять слишком много текста, просто укажу, что все необходимые поля, связи и требования можно посмотреть в работе самой Софьи по ссылке выше.

Можно отметить, что сущность Users уже существует, а поменять имя или ID я не имею возможности. В дальнейшем это как раз таки и вызовет проблемы.

![Pasted image 20240917103042.png](/img/user/Pasted%20image%2020240917103042.png)

На текущий момент сама сущность будет выглядеть вот так. Так как никаких дополнительных требований по длине, проверки ввода или чему-либо еще не требуется, то сущность будет выглядеть вот так, но по не совсем ясной для меня причине, Strapi выдает ошибку при сохранении. Скорее всего, это происходит из-за совпадения имен сущностей, но на этом этапе смена имени уже не помогает. Поэтому поменяем имя сущности на SiteUsers и вновь заполним все поля.
![Pasted image 20240917104222.png](/img/user/Pasted%20image%2020240917104222.png)

На текущий момент Cущность пользователей выглядит так. 
![Pasted image 20240917105340.png](/img/user/Pasted%20image%2020240917105340.png)

Уже после проведения пары первый пары по дедлайну этого задания мне пришлось вновь User для того, чтобы не создавать лишних сущностей. На данный момент поле выглядит вот так.

![Pasted image 20240923093955.png](/img/user/Pasted%20image%2020240923093955.png)

### Cущность Режиссер (director)
Создание сущности режиссера прошла без каких либо проблем. И так как никаких комментариев к полям нет, ничего менять или добавлять не будем.
![Pasted image 20240917105933.png](/img/user/Pasted%20image%2020240917105933.png)

### Сущность Фильмы (Movie)

Что бы вновь не повторяться и не описывать уже пройденные шаги просто приложу скриншоты создания этой сущности и других следующих. Проверку работы самого Strapi приложу в конце.

![Pasted image 20240923094434.png](/img/user/Pasted%20image%2020240923094434.png)
### Сущность Актер (Actor)
![Pasted image 20240923094549.png](/img/user/Pasted%20image%2020240923094549.png)
### Сущность Отзыв (review)
![Pasted image 20240923094620.png](/img/user/Pasted%20image%2020240923094620.png)

### Сущность Оценка (rating)
![Pasted image 20240923094640.png](/img/user/Pasted%20image%2020240923094640.png)

### Проверка работы API
http://localhost:1337/api/actors - просто видим всех актеров
```
{
  "data": [
    {
      "id": 1,
      "attributes": {
        "Actor_id": "121",
        "name": "Тестовый Генадий Александрович",
        "biography": "Жил, был, умер",
        "awards": [
          "Важная награда 1",
          "Важная награда 2",
          "Важная награда 3"
        ],
        "createdAt": "2024-09-23T06:56:03.591Z",
        "updatedAt": "2024-09-23T06:57:57.133Z",
        "publishedAt": "2024-09-23T06:57:57.129Z"
      }
    },
    {
      "id": 2,
      "attributes": {
        "Actor_id": "321",
        "name": "Тестовая Анна Григорьева",
        "biography": "Жила, была, еще живет",
        "awards": [
          "Не очень важная награда",
          "Очень важная награда"
        ],
        "createdAt": "2024-09-23T06:56:48.321Z",
        "updatedAt": "2024-09-23T06:57:53.175Z",
        "publishedAt": "2024-09-23T06:57:53.171Z"
      }
    },
    {
      "id": 3,
      "attributes": {
        "Actor_id": "421",
        "name": "Текстовый Петр Петрович",
        "biography": "Жил, был, будет жить",
        "awards": [
          "Награда один",
          "Награда два"
        ],
        "createdAt": "2024-09-23T06:57:40.901Z",
        "updatedAt": "2024-09-23T06:57:49.400Z",
        "publishedAt": "2024-09-23T06:57:49.396Z"
      }
    }
  ],
  "meta": {
    "pagination": {
      "page": 1,
      "pageSize": 25,
      "pageCount": 1,
      "total": 3
    }
  }
}

```

http://localhost:1337/api/movies - видим все фильмы
```
{
  "data": [
    {
      "id": 1,
      "attributes": {
        "Movie_id": "111",
        "name": "Далеко и долго",
        "hours_amount": 2,
        "release_date": "2024-09-02",
        "description": "Фильм о том, как кто-то едет очень далеко и долго",
        "rating_amount": null,
        "comments": null,
        "createdAt": "2024-09-23T06:59:25.604Z",
        "updatedAt": "2024-09-23T06:59:27.549Z",
        "publishedAt": "2024-09-23T06:59:27.538Z"
      }
    }
  ],
  "meta": {
    "pagination": {
      "page": 1,
      "pageSize": 25,
      "pageCount": 1,
      "total": 1
    }
  }
}

```
 
 http://localhost:1337/api/actors?filters[Actor_id][$eq]=121 - ищем актера с ID 121
```
{
  "data": [
    {
      "id": 1,
      "attributes": {
        "Actor_id": "121",
        "name": "Тестовый Генадий Александрович",
        "biography": "Жил, был, умер",
        "awards": [
          "Важная награда 1",
          "Важная награда 2",
          "Важная награда 3"
        ],
        "createdAt": "2024-09-23T06:56:03.591Z",
        "updatedAt": "2024-09-23T06:57:57.133Z",
        "publishedAt": "2024-09-23T06:57:57.129Z"
      }
    }
  ]
}

```

### Прочее 

